var Ie=Object.defineProperty,ae=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,me=(h,v,o)=>v in h?Ie(h,v,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[v]=o,le=(h,v)=>{for(var o in v||(v={}))ve.call(v,o)&&me(h,o,v[o]);if(ae)for(var o of ae(v))ye.call(v,o)&&me(h,o,v[o]);return h},_e=(h,v)=>{var o={};for(var g in h)ve.call(h,g)&&v.indexOf(g)<0&&(o[g]=h[g]);if(null!=h&&ae)for(var g of ae(h))v.indexOf(g)<0&&ye.call(h,g)&&(o[g]=h[g]);return o};(self.webpackChunkclips=self.webpackChunkclips||[]).push([[115],{8292:(h,v,o)=>{o(5555);const{devDependencies:f}=o(3681);h.exports={corePath:`https://unpkg.com/@ffmpeg/core@${f["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}},2187:(h,v,o)=>{var g=o(8926).default;const f=o(5555);h.exports=function(){var y=g(function*(e){let _=e;return void 0===e?new Uint8Array:("string"==typeof e?_=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map(b=>b.charCodeAt(0)):yield(yield fetch(f(e))).arrayBuffer():(e instanceof File||e instanceof Blob)&&(_=yield(y=>new Promise((e,_)=>{const b=new FileReader;b.onload=()=>{e(b.result)},b.onerror=({target:{error:{code:d}}})=>{_(Error(`File could not be read! Code=${d}`))},b.readAsArrayBuffer(y)}))(e)),new Uint8Array(_))});return function(e){return y.apply(this,arguments)}}()},9965:(h,v,o)=>{var g=o(8926).default;const f=o(5555),{log:m}=o(6945),y=function(){var e=g(function*(_,b){m("info",`fetch ${_}`);const d=yield(yield fetch(_)).arrayBuffer();m("info",`${_} file size = ${d.byteLength} bytes`);const T=new Blob([d],{type:b}),M=URL.createObjectURL(T);return m("info",`${_} blob URL = ${M}`),M});return function(b,d){return e.apply(this,arguments)}}();h.exports=function(){var e=g(function*({corePath:_}){if("string"!=typeof _)throw Error("corePath should be a string!");const b=f(_),d=yield y(b,"application/javascript"),T=yield y(b.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),M=yield y(b.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return"undefined"==typeof createFFmpegCore?new Promise(B=>{const P=document.createElement("script"),I=()=>{P.removeEventListener("load",I),m("info","ffmpeg-core.js script loaded"),B({createFFmpegCore,corePath:d,wasmPath:T,workerPath:M})};P.src=d,P.type="text/javascript",P.addEventListener("load",I),document.getElementsByTagName("head")[0].appendChild(P)}):(m("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:d,wasmPath:T,workerPath:M}))});return function(_){return e.apply(this,arguments)}}()},1346:(h,v,o)=>{const g=o(8292),f=o(9965),m=o(2187);h.exports={defaultOptions:g,getCreateFFmpegCore:f,fetchFile:m}},6151:h=>{h.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},9639:(h,v,o)=>{var g=o(8926).default;const{defaultArgs:f,baseOptions:m}=o(6151),{setLogging:y,setCustomLogger:e,log:_}=o(6945),b=o(5542),d=o(8333),{defaultOptions:T,getCreateFFmpegCore:M}=o(1346),{version:B}=o(3681),P=Error("ffmpeg.wasm is not ready, make sure you have completed load().");h.exports=(I={})=>{const i=le(le(le({},m),T),I),{log:J,logger:Z,progress:Q}=i,k=_e(i,["log","logger","progress"]);let A=null,Y=null,O=null,G=!1,N=Q;const j=({type:n,message:a})=>{_(n,a),b(a,N),(n=>{"FFMPEG_END"===n&&null!==O&&(O(),O=null,G=!1)})(a)},ee=function(){var n=g(function*(){if(_("info","load ffmpeg-core"),null!==A)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{_("info","loading ffmpeg-core");const{createFFmpegCore:a,corePath:u,workerPath:p,wasmPath:w}=yield M(k);A=yield a({mainScriptUrlOrBlob:u,printErr:C=>j({type:"fferr",message:C}),print:C=>j({type:"ffout",message:C}),locateFile:(C,S)=>{if("undefined"!=typeof window){if(void 0!==w&&C.endsWith("ffmpeg-core.wasm"))return w;if(void 0!==p&&C.endsWith("ffmpeg-core.worker.js"))return p}return S+C}}),Y=A.cwrap("proxy_main","number",["number","number"]),_("info","ffmpeg-core loaded")}});return function(){return n.apply(this,arguments)}}();return y(J),e(Z),_("info",`use ffmpeg.wasm v${B}`),{setProgress:n=>{N=n},setLogger:n=>{e(n)},setLogging:y,load:ee,isLoaded:()=>null!==A,run:(...n)=>{if(_("info",`run ffmpeg command: ${n.join(" ")}`),null===A)throw P;if(G)throw Error("ffmpeg.wasm can only run one command at a time");return G=!0,new Promise(a=>{const u=[...f,...n].filter(p=>0!==p.length);O=a,Y(...d(A,u))})},exit:()=>{if(null===A)throw P;G=!1,A.exit(1),A=null,Y=null,O=null},FS:(n,...a)=>{if(_("info",`run FS.${n} ${a.map(u=>"string"==typeof u?u:`<${u.length} bytes binary file>`).join(" ")}`),null===A)throw P;{let u=null;try{u=A.FS[n](...a)}catch(p){throw Error("readdir"===n?`ffmpeg.FS('readdir', '${a[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:"readFile"===n?`ffmpeg.FS('readFile', '${a[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return u}}}}},260:(h,v,o)=>{o(7854);const g=o(9639),{fetchFile:f}=o(1346);h.exports={createFFmpeg:g,fetchFile:f}},6945:h=>{let v=!1,o=()=>{};h.exports={logging:v,setLogging:y=>{v=y},setCustomLogger:y=>{o=y},log:(y,e)=>{o({type:y,message:e}),v&&console.log(`[${y}] ${e}`)}}},8333:h=>{h.exports=(v,o)=>{const g=v._malloc(o.length*Uint32Array.BYTES_PER_ELEMENT);return o.forEach((f,m)=>{const y=v._malloc(f.length+1);v.writeAsciiToMemory(f,y),v.setValue(g+Uint32Array.BYTES_PER_ELEMENT*m,y,"i32")}),[o.length,g]}},5542:h=>{let v=0,o=0;const g=f=>{const[m,y,e]=f.split(":");return 60*parseFloat(m)*60+60*parseFloat(y)+parseFloat(e)};h.exports=(f,m)=>{if("string"==typeof f)if(f.startsWith("  Duration")){const y=f.split(", ")[0].split(": ")[1],e=g(y);m({duration:e,ratio:o}),(0===v||v>e)&&(v=e)}else if(f.startsWith("frame")||f.startsWith("size")){const y=f.split("time=")[1].split(" ")[0],e=g(y);o=e/v,m({ratio:o,time:e})}else f.startsWith("video:")&&(m({ratio:1}),v=0)}},4115:(h,v,o)=>{"use strict";o.r(v),o.d(v,{VideoModule:()=>ke});var g=o(9808),f=o(5367),m=o(5861),y=o(1135),e=o(5e3),_=o(1518),b=o(7583),d=o(3075),T=o(3446),M=o(8549),B=o(235);function P(r,l){if(1&r&&(e.TgZ(0,"app-alert",9)(1,"p"),e._uU(2),e.qZA()()),2&r){const t=e.oxw();e.Q6J("color",t.alertMessageColor),e.xp6(2),e.Oqu(t.alertMessage)}}let I=(()=>{class r{constructor(t,s){this.clipService=t,this.modalService=s,this.clip=null,this.clipUpdated=new e.vpe,this.alertMessageColor="red",this.alertMessage="",this.titleControl=new d.NI("",[d.kI.required,d.kI.minLength(3)]),this.clipFormGroup=new d.cw({title:this.titleControl})}ngOnChanges(t){!this.clip||this.titleControl.setValue(this.clip.title)}ngOnInit(){}get showAlertMessage(){return!!this.alertMessage}updateClip(){this.clip.title=this.titleControl.value,this.clipFormGroup.disable(),this.alertMessage="Please wait! Your clip is being updated ...",this.alertMessageColor="blue",this.clipService.updateClip(this.clip).subscribe({next:()=>{this.alertMessage="Success! Your clip is updated \u{1f973}",this.alertMessageColor="green",setTimeout(()=>{this.modalService.toggleModal("edit-clip")},1e3),this.clipUpdated.emit(this.clip)},error:t=>{this.alertMessage="Update is failed, Please try again later, Or if you curious check the cosole error ... \u{1f914}",console.error(t),this.alertMessageColor="red"}}),this.clipFormGroup.enable()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(_.Y),e.Y36(b.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],inputs:{clip:"clip"},outputs:{clipUpdated:"clipUpdated"},features:[e.TTD],decls:12,vars:3,consts:[["modalId","edit-clip"],["heading","",1,"text-2xl","font-bold"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none"],[3,"color"]],template:function(t,s){1&t&&(e.TgZ(0,"app-modal",0)(1,"p",1),e._uU(2,"Edit Video"),e.qZA(),e.YNc(3,P,3,2,"app-alert",2),e.TgZ(4,"form",3),e.NdJ("ngSubmit",function(){return s.updateClip()}),e.TgZ(5,"div",4)(6,"label",5),e._uU(7,"Title"),e.qZA(),e._UZ(8,"app-input",6),e.qZA(),e.TgZ(9,"div",7)(10,"button",8),e._uU(11," Update "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",s.showAlertMessage),e.xp6(1),e.Q6J("formGroup",s.clipFormGroup),e.xp6(4),e.Q6J("control",s.titleControl))},directives:[T.z,g.O5,M.w,d._Y,d.JL,d.sg,B.a],styles:[""]}),r})();const J=function(r){return["/","clip",r]};function Z(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",10)(1,"a",11),e._UZ(2,"img",12),e.qZA(),e.TgZ(3,"div",13)(4,"a",14),e._uU(5),e.qZA(),e.TgZ(6,"a",15),e.NdJ("click",function(c){const F=e.CHM(t).$implicit;return e.oxw().copyToClilpboard(c,F.id)}),e._uU(7," Copy Link "),e.qZA()(),e.TgZ(8,"div",16)(9,"a",17),e.NdJ("click",function(c){const F=e.CHM(t).$implicit;return e.oxw().openModal(c,F)}),e.TgZ(10,"span",18),e._uU(11,"build"),e.qZA()(),e.TgZ(12,"a",19),e.NdJ("click",function(c){const F=e.CHM(t).$implicit;return e.oxw().deleteClip(c,F)}),e.TgZ(13,"span",18),e._uU(14,"delete"),e.qZA()()()()}if(2&r){const t=l.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(4,J,t.id)),e.xp6(1),e.Q6J("src",t.screenshotUrl,e.LSH),e.xp6(2),e.Q6J("routerLink",e.VKq(6,J,t.id)),e.xp6(1),e.hij(" ",t.title," ")}}let Q=(()=>{class r{constructor(t,s,c,x){this.router=t,this.activatedRoute=s,this.clipService=c,this.modalService=x,this.orderBy="1",this.clips=[],this.currentClip=null,this.sort$=new y.X("1")}ngOnInit(){this.activatedRoute.queryParams.subscribe(t=>{this.orderBy="2"===t.sort?t.sort:"1",this.getUserClips()})}sort(t){const{value:s}=t.target;this.router.navigateByUrl(`/manage?sort=${s}`),this.sort$.next(s)}getUserClips(){this.clips=[],this.sort$.subscribe(t=>{this.clipService.getUserClips(t).then(s=>{s.forEach(c=>{this.clips.push(Object.assign(Object.assign({},c.data()),{id:c.id}))})})})}openModal(t,s){t.preventDefault(),this.currentClip=s,this.modalService.toggleModal("edit-clip")}onClipUpdated(t){}deleteClip(t,s){var c=this;return(0,m.Z)(function*(){t.preventDefault();try{yield c.clipService.deleteClip(s),c.clips.forEach((x,F)=>{x.id==s.id&&c.clips.splice(F,1)})}catch(x){console.error(x)}})()}copyToClilpboard(t,s){return(0,m.Z)(function*(){t.preventDefault();const c=`${location.origin}/clip/${s}`;yield navigator.clipboard.writeText(c),alert("Link Copied \u{1f44c}")})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(f.F0),e.Y36(f.gz),e.Y36(_.Y),e.Y36(b.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-manage"]],decls:13,vars:4,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","justify-between"],["routerLink","/upload",1,"bg-indigo-400","text-white","py-4","px-10","text-xl"],[1,"text-black","px-8","text-xl","outline-none","appearance-none",3,"change"],["value","1",3,"selected"],["value","2",3,"selected"],[1,"container","mx-auto","my-8"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start",4,"ngFor","ngForOf"],[3,"clip","clipUpdated"],[1,"mt-6","rounded-tl-2xl","rounded-br-2xl","shadow-xl","bg-secondary","flex","flex-col","justify-start"],[3,"routerLink"],["crossorigin","",1,"card-img-top","rounded-tl-2xl","w-full",3,"src"],[1,"p-6","text-2xl"],[1,"font-bold","mb-2",3,"routerLink"],["href","#",1,"bg-gray-400","text-white","px-2","py-1","ml-2","text-sm","rounded",3,"click"],[1,"flex","text-center","text-2xl","bg-gray-800","p-2","mt-auto"],[1,"flex-1","p-2","border-right","border-r-2","border-gray-700","transition","hover:text-indigo-400",3,"click"],[1,"material-icons","text-base"],[1,"flex-1","p-2","rounded-br-2xl","transition","hover:text-indigo-400",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"a",2),e._uU(3,"Upload Videos"),e.qZA(),e.TgZ(4,"select",3),e.NdJ("change",function(x){return s.sort(x)}),e.TgZ(5,"option",4),e._uU(6,"Recent Uploads"),e.qZA(),e.TgZ(7,"option",5),e._uU(8,"Oldest Uploads"),e.qZA()()()(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,Z,15,8,"div",8),e.qZA()(),e.TgZ(12,"app-edit",9),e.NdJ("clipUpdated",function(x){return s.onClipUpdated(x)}),e.qZA()),2&t&&(e.xp6(5),e.Q6J("selected","1"==s.orderBy),e.xp6(2),e.Q6J("selected","2"==s.orderBy),e.xp6(4),e.Q6J("ngForOf",s.clips),e.xp6(1),e.Q6J("clip",s.currentClip))},directives:[f.yS,d.YN,d.Kr,g.sg,I],styles:[""]}),r})();var k,A=new Uint8Array(16);function Y(){if(!k&&!(k="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(A)}const O=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,N=function G(r){return"string"==typeof r&&O.test(r)};for(var U=[],j=0;j<256;++j)U.push((j+256).toString(16).substr(1));const V=function te(r,l,t){var s=(r=r||{}).random||(r.rng||Y)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,l){t=t||0;for(var c=0;c<16;++c)l[t+c]=s[c];return l}return function ee(r){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(U[r[l+0]]+U[r[l+1]]+U[r[l+2]]+U[r[l+3]]+"-"+U[r[l+4]]+U[r[l+5]]+"-"+U[r[l+6]]+U[r[l+7]]+"-"+U[r[l+8]]+U[r[l+9]]+"-"+U[r[l+10]]+U[r[l+11]]+U[r[l+12]]+U[r[l+13]]+U[r[l+14]]+U[r[l+15]]).toLowerCase();if(!N(t))throw TypeError("Stringified UUID is invalid");return t}(s)};var H=o(127),z=o(3900),X=o(9841),i=o(4128),n=o(2084),a=o(656),u=o(260);let p=(()=>{class r{constructor(){this.isReady=!1,this.isRunning=!1,this.ffmpeg=(0,u.createFFmpeg)({log:!0})}init(){var t=this;return(0,m.Z)(function*(){t.isReady||(yield t.ffmpeg.load(),t.isReady=!0)})()}getScreenshots(t){var s=this;return(0,m.Z)(function*(){s.isRunning=!0;const c=yield(0,u.fetchFile)(t);s.ffmpeg.FS("writeFile",t.name,c);const x=[1,2,3],F=[];x.forEach($=>{F.push("-i",t.name,"-ss",`00:00:0${$}`,"-frames:v","1","-filter:v","scale=510:-1",`output_0${$}.png`)}),yield s.ffmpeg.run(...F);const E=[];return x.forEach($=>{const de=s.ffmpeg.FS("readFile",`output_0${$}.png`),ne=new Blob([de.buffer],{type:"image/png"}),fe=URL.createObjectURL(ne);E.push(fe)}),s.isRunning=!1,E})()}blobFromURL(t){return(0,m.Z)(function*(){return yield(yield fetch(t)).blob()})()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),w=(()=>{class r{hadleEvent(t){t.preventDefault(),t.stopPropagation()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["","app-event-bloker",""]],hostBindings:function(t,s){1&t&&e.NdJ("drop",function(x){return s.hadleEvent(x)})("dragover",function(x){return s.hadleEvent(x)})}}),r})();var C=o(2313);let S=(()=>{class r{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustUrl(t)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(C.H7,16))},r.\u0275pipe=e.Yjl({name:"safeURL",type:r,pure:!0}),r})();function R(r,l){1&r&&(e.TgZ(0,"span",9),e._uU(1," autorenew "),e.qZA())}const L=function(r){return{"bg-indigo-400 border-indigo-400 border-solid":r}};function re(r,l){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",6),e.NdJ("change",function(c){return e.CHM(t),e.oxw(2).storeFile(c)}),e.qZA(),e.TgZ(2,"div",7),e.NdJ("dragend",function(){return e.CHM(t),e.oxw(2).isDragover=!1})("dragover",function(){return e.CHM(t),e.oxw(2).isDragover=!0})("dragenter",function(){return e.CHM(t),e.oxw(2).isDragover=!0})("dragleave",function(){return e.CHM(t),e.oxw(2).isDragover=!1})("mouseleave",function(){return e.CHM(t),e.oxw(2).isDragover=!1})("drop",function(c){return e.CHM(t),e.oxw(2).storeFile(c)}),e.TgZ(3,"h5"),e._uU(4,"Drop your file here (mp4 only!)"),e.qZA(),e.YNc(5,R,2,0,"span",8),e.qZA(),e.BQk()}if(2&r){const t=e.oxw(2);e.xp6(2),e.Q6J("ngClass",e.VKq(2,L,t.isDragover)),e.xp6(3),e.Q6J("ngIf",t.isRunning)}}function W(r,l){if(1&r&&(e.ynx(0),e.YNc(1,re,6,4,"ng-container",3),e.BQk()),2&r){const t=e.oxw(),s=e.MAs(6);e.xp6(1),e.Q6J("ngIf",!t.nextStep)("ngIfElse",s)}}function D(r,l){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&r){const t=e.oxw(3);e.xp6(1),e.Oqu(e.lcZ(2,1,t.percentage))}}function xe(r,l){if(1&r&&(e.TgZ(0,"app-alert",20)(1,"p"),e._uU(2),e.qZA(),e.YNc(3,D,3,3,"p",21),e.qZA()),2&r){const t=e.oxw(2);e.Q6J("color",t.alertMessageColor),e.xp6(2),e.Oqu(t.alertMessage),e.xp6(1),e.Q6J("ngIf",t.showPercentage)}}const be=function(r,l){return{"border-green-400":r,"border-transparent":l}};function we(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",22)(1,"img",23),e.NdJ("click",function(){const x=e.CHM(t).$implicit;return e.oxw(2).imageSelected(x)}),e.ALo(2,"safeURL"),e.qZA()()}if(2&r){const t=l.$implicit,s=e.oxw(2);e.Q6J("ngClass",e.WLB(4,be,t==s.selectedScreenshot,t!=s.selectedScreenshot)),e.xp6(1),e.Q6J("src",e.lcZ(2,2,t),e.LSH)}}const Ce=function(r,l){return{"opacity-50":r,"hover:bg-indigo-700":l}};function Te(r,l){if(1&r){const t=e.EpF();e.YNc(0,xe,4,3,"app-alert",10),e.TgZ(1,"form",11),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().uploadFile()}),e.TgZ(2,"h2",12),e._uU(3,"Select a Thumbnail"),e.qZA(),e.TgZ(4,"div",13),e.YNc(5,we,3,7,"div",14),e.qZA(),e.TgZ(6,"div",15)(7,"label",16),e._uU(8,"Title"),e.qZA(),e._UZ(9,"app-input",17),e.qZA(),e.TgZ(10,"div",18)(11,"button",19),e._uU(12," Publish "),e.qZA()()()}if(2&r){const t=e.oxw();e.Q6J("ngIf",t.showAlertMessage),e.xp6(1),e.Q6J("formGroup",t.uploadForm),e.xp6(4),e.Q6J("ngForOf",t.screenshots),e.xp6(4),e.Q6J("control",t.titleControl),e.xp6(2),e.Q6J("disabled",t.isUploading)("ngClass",e.WLB(6,Ce,t.isUploading,!t.isUploading))}}function Ue(r,l){1&r&&(e.TgZ(0,"span",9),e._uU(1," settings "),e.qZA())}let Fe=(()=>{class r{constructor(t,s,c,x,F){this.storage=t,this.authService=s,this.clilpService=c,this.router=x,this.ffmpegService=F,this.isUploading=!1,this.isDragover=!1,this.file=null,this.nextStep=!1,this.alertMessageColor="red",this.alertMessage="",this.percentage=0,this.user=null,this.screenshots=[],this.selectedScreenshot="",this.titleControl=new d.NI("",[d.kI.required,d.kI.minLength(3)]),this.uploadForm=new d.cw({title:this.titleControl}),this.authService.getUser().subscribe(E=>{this.user=E}),this.ffmpegService.init()}get showAlertMessage(){return!!this.alertMessage}get showPercentage(){return!!this.percentage}ngOnInit(){}storeFile(t){var s=this;return(0,m.Z)(function*(){var c,x,F,E;s.ffmpegService.isRunning||(s.file=t.dataTransfer?null!==(x=null===(c=t.dataTransfer)||void 0===c?void 0:c.files.item(0))&&void 0!==x?x:null:null!==(E=null===(F=t.target.files)||void 0===F?void 0:F.item(0))&&void 0!==E?E:null,s.file&&"video/mp4"===s.file.type&&(s.screenshots=yield s.ffmpegService.getScreenshots(s.file),s.selectedScreenshot=s.screenshots[0],s.titleControl.setValue(s.file.name.replace(/\.[^/.]+$/,"")),s.nextStep=!0))})()}uploadFile(){var t=this;return(0,m.Z)(function*(){var s,c,x;t.uploadForm.disable(),t.isUploading=!0;const F=V(),$=`clips/${F}.mp4`,de=yield t.ffmpegService.blobFromURL(t.selectedScreenshot),ne=`screenshots/${F}.png`;t.alertMessage="Please wait! Your file is being uploaded ...",t.alertMessageColor="blue",t.uploadFileTask=t.storage.upload($,t.file);const fe=t.storage.ref($);t.uploadScreenshotTask=t.storage.upload(ne,de);const Oe=t.storage.ref(ne);var oe;(0,X.a)([null===(s=t.uploadFileTask)||void 0===s?void 0:s.percentageChanges(),null===(c=t.uploadScreenshotTask)||void 0===c?void 0:c.percentageChanges()]).subscribe(oe=>{const[ie,K]=oe;ie&&K&&(t.percentage=(ie+K)/200)}),(0,i.D)([null===(x=t.uploadFileTask)||void 0===x?void 0:x.snapshotChanges(),t.uploadScreenshotTask.snapshotChanges()]).pipe((0,z.w)(()=>(0,i.D)([fe.getDownloadURL(),Oe.getDownloadURL()]))).subscribe({next:(oe=(0,m.Z)(function*(ie){var K,se,ge;const[Ge,Ne]=ie,je={uid:null===(K=t.user)||void 0===K?void 0:K.uid,displayName:null===(se=t.user)||void 0===se?void 0:se.displayName,clipPath:$,screenshotPath:ne,fileName:null===(ge=t.file)||void 0===ge?void 0:ge.name,title:t.titleControl.value,url:Ge,screenshotUrl:Ne,timestamp:H.Z.firestore.FieldValue.serverTimestamp()},Be=yield t.clilpService.createClip(je);t.alertMessage="Success! Your clip is now ready to share \u{1f973}",t.alertMessageColor="green",t.redirectToClipPage(Be.id)}),function(K){return oe.apply(this,arguments)}),error:oe=>{t.alertMessage="Upload is failed, Please try again later, Or if you curious check the cosole error ... \u{1f914}",console.error(oe),t.alertMessageColor="red",t.uploadForm.enable()},complete:()=>{t.isUploading=!1,t.percentage=0}})})()}ngOnDestroy(){var t;null===(t=this.uploadFileTask)||void 0===t||t.cancel()}redirectToClipPage(t){setTimeout(()=>{this.router.navigate(["clip",t])},1e3)}imageSelected(t){this.selectedScreenshot=t}get isReady(){return this.ffmpegService.isReady}get isRunning(){return this.ffmpegService.isRunning}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(n.Q1),e.Y36(a.e),e.Y36(_.Y),e.Y36(f.F0),e.Y36(p))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-upload"]],decls:9,vars:2,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","flex-col"],[1,"font-bold","mb-6"],[4,"ngIf","ngIfElse"],["uploadFormContainer",""],["loadingContainer",""],["type","file",1,"mb-4",3,"change"],["app-event-bloker","",1,"w-full","px-10","py-40","rounded","text-center","cursor-pointer","border","border-dashed","border-gray-400","transition","duration-500","hover:text-white","hover:bg-indigo-400","hover:border-indigo-400","hover:border-solid","text-xl",3,"ngClass","dragend","dragover","dragenter","dragleave","mouseleave","drop"],["class","material-icons text-center text-6xl p-8 animate-spin",4,"ngIf"],[1,"material-icons","text-center","text-6xl","p-8","animate-spin"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mb-4","text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","border-8 cursor-pointer",3,"ngClass",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color"],[4,"ngIf"],[1,"border-8","cursor-pointer",3,"ngClass"],[3,"src","click"]],template:function(t,s){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._uU(3,"Upload Video"),e.qZA(),e.YNc(4,W,2,2,"ng-container",3),e.YNc(5,Te,13,9,"ng-template",null,4,e.W1O),e.YNc(7,Ue,2,0,"ng-template",null,5,e.W1O),e.qZA()()),2&t){const c=e.MAs(8);e.xp6(4),e.Q6J("ngIf",s.isReady)("ngIfElse",c)}},directives:[g.O5,w,g.mk,M.w,d._Y,d.JL,d.sg,g.sg,B.a],pipes:[g.Zx,S],styles:[""]}),r})();var Ae=o(9635),ce=o(4004),Se=o(5698),Ee=o(1205);const ue=(0,ce.U)(r=>!!r);let pe=(()=>{class r{constructor(t,s){this.router=t,this.auth=s,this.canActivate=(c,x)=>{const F=c.data.authGuardPipe||(()=>ue);return this.auth.user.pipe((0,Se.q)(1),F(c,x),(0,ce.U)(E=>"boolean"==typeof E?E:Array.isArray(E)?this.router.createUrlTree(E):this.router.parseUrl(E)))}}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(f.F0),e.LFG(Ee.zQ))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"any"}),r})();const he=()=>("/",(0,Ae.z)(ue,(0,ce.U)(l=>l||"/"))),Ze=[{path:"manage-clips",redirectTo:"manage"},{path:"manage",component:Q,canActivate:[pe],data:{authOnly:!0,authGuardPipe:he}},{path:"upload",component:Fe,canActivate:[pe],data:{authOnly:!0,authGuardPipe:he}}];let Re=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[f.Bz.forChild(Ze)],f.Bz]}),r})();var Pe=o(4466);let ke=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[g.ez,Re,Pe.m,d.UX]]}),r})()},7854:h=>{var v=function(o){"use strict";var m,g=Object.prototype,f=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},e=y.iterator||"@@iterator",_=y.asyncIterator||"@@asyncIterator",b=y.toStringTag||"@@toStringTag";function d(i,n,a){return Object.defineProperty(i,n,{value:a,enumerable:!0,configurable:!0,writable:!0}),i[n]}try{d({},"")}catch(i){d=function(n,a,u){return n[a]=u}}function T(i,n,a,u){var w=Object.create((n&&n.prototype instanceof Q?n:Q).prototype),C=new H(u||[]);return w._invoke=function ee(i,n,a){var u=B;return function(w,C){if(u===I)throw new Error("Generator is already running");if(u===J){if("throw"===w)throw C;return X()}for(a.method=w,a.arg=C;;){var S=a.delegate;if(S){var R=q(S,a);if(R){if(R===Z)continue;return R}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(u===B)throw u=J,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);u=I;var L=M(i,n,a);if("normal"===L.type){if(u=a.done?J:P,L.arg===Z)continue;return{value:L.arg,done:a.done}}"throw"===L.type&&(u=J,a.method="throw",a.arg=L.arg)}}}(i,a,C),w}function M(i,n,a){try{return{type:"normal",arg:i.call(n,a)}}catch(u){return{type:"throw",arg:u}}}o.wrap=T;var B="suspendedStart",P="suspendedYield",I="executing",J="completed",Z={};function Q(){}function k(){}function A(){}var Y={};d(Y,e,function(){return this});var O=Object.getPrototypeOf,G=O&&O(O(z([])));G&&G!==g&&f.call(G,e)&&(Y=G);var N=A.prototype=Q.prototype=Object.create(Y);function U(i){["next","throw","return"].forEach(function(n){d(i,n,function(a){return this._invoke(n,a)})})}function j(i,n){function a(w,C,S,R){var L=M(i[w],i,C);if("throw"!==L.type){var re=L.arg,W=re.value;return W&&"object"==typeof W&&f.call(W,"__await")?n.resolve(W.__await).then(function(D){a("next",D,S,R)},function(D){a("throw",D,S,R)}):n.resolve(W).then(function(D){re.value=D,S(re)},function(D){return a("throw",D,S,R)})}R(L.arg)}var u;this._invoke=function p(w,C){function S(){return new n(function(R,L){a(w,C,R,L)})}return u=u?u.then(S,S):S()}}function q(i,n){var a=i.iterator[n.method];if(a===m){if(n.delegate=null,"throw"===n.method){if(i.iterator.return&&(n.method="return",n.arg=m,q(i,n),"throw"===n.method))return Z;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return Z}var u=M(a,i.iterator,n.arg);if("throw"===u.type)return n.method="throw",n.arg=u.arg,n.delegate=null,Z;var p=u.arg;return p?p.done?(n[i.resultName]=p.value,n.next=i.nextLoc,"return"!==n.method&&(n.method="next",n.arg=m),n.delegate=null,Z):p:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,Z)}function te(i){var n={tryLoc:i[0]};1 in i&&(n.catchLoc=i[1]),2 in i&&(n.finallyLoc=i[2],n.afterLoc=i[3]),this.tryEntries.push(n)}function V(i){var n=i.completion||{};n.type="normal",delete n.arg,i.completion=n}function H(i){this.tryEntries=[{tryLoc:"root"}],i.forEach(te,this),this.reset(!0)}function z(i){if(i){var n=i[e];if(n)return n.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length)){var a=-1,u=function p(){for(;++a<i.length;)if(f.call(i,a))return p.value=i[a],p.done=!1,p;return p.value=m,p.done=!0,p};return u.next=u}}return{next:X}}function X(){return{value:m,done:!0}}return k.prototype=A,d(N,"constructor",A),d(A,"constructor",k),k.displayName=d(A,b,"GeneratorFunction"),o.isGeneratorFunction=function(i){var n="function"==typeof i&&i.constructor;return!!n&&(n===k||"GeneratorFunction"===(n.displayName||n.name))},o.mark=function(i){return Object.setPrototypeOf?Object.setPrototypeOf(i,A):(i.__proto__=A,d(i,b,"GeneratorFunction")),i.prototype=Object.create(N),i},o.awrap=function(i){return{__await:i}},U(j.prototype),d(j.prototype,_,function(){return this}),o.AsyncIterator=j,o.async=function(i,n,a,u,p){void 0===p&&(p=Promise);var w=new j(T(i,n,a,u),p);return o.isGeneratorFunction(n)?w:w.next().then(function(C){return C.done?C.value:w.next()})},U(N),d(N,b,"Generator"),d(N,e,function(){return this}),d(N,"toString",function(){return"[object Generator]"}),o.keys=function(i){var n=[];for(var a in i)n.push(a);return n.reverse(),function u(){for(;n.length;){var p=n.pop();if(p in i)return u.value=p,u.done=!1,u}return u.done=!0,u}},o.values=z,H.prototype={constructor:H,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(V),!i)for(var n in this)"t"===n.charAt(0)&&f.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=m)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var n=this;function a(R,L){return w.type="throw",w.arg=i,n.next=R,L&&(n.method="next",n.arg=m),!!L}for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u],w=p.completion;if("root"===p.tryLoc)return a("end");if(p.tryLoc<=this.prev){var C=f.call(p,"catchLoc"),S=f.call(p,"finallyLoc");if(C&&S){if(this.prev<p.catchLoc)return a(p.catchLoc,!0);if(this.prev<p.finallyLoc)return a(p.finallyLoc)}else if(C){if(this.prev<p.catchLoc)return a(p.catchLoc,!0)}else{if(!S)throw new Error("try statement without catch or finally");if(this.prev<p.finallyLoc)return a(p.finallyLoc)}}}},abrupt:function(i,n){for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a];if(u.tryLoc<=this.prev&&f.call(u,"finallyLoc")&&this.prev<u.finallyLoc){var p=u;break}}p&&("break"===i||"continue"===i)&&p.tryLoc<=n&&n<=p.finallyLoc&&(p=null);var w=p?p.completion:{};return w.type=i,w.arg=n,p?(this.method="next",this.next=p.finallyLoc,Z):this.complete(w)},complete:function(i,n){if("throw"===i.type)throw i.arg;return"break"===i.type||"continue"===i.type?this.next=i.arg:"return"===i.type?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):"normal"===i.type&&n&&(this.next=n),Z},finish:function(i){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.finallyLoc===i)return this.complete(a.completion,a.afterLoc),V(a),Z}},catch:function(i){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc===i){var u=a.completion;if("throw"===u.type){var p=u.arg;V(a)}return p}}throw new Error("illegal catch attempt")},delegateYield:function(i,n,a){return this.delegate={iterator:z(i),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=m),Z}},o}(h.exports);try{regeneratorRuntime=v}catch(o){"object"==typeof globalThis?globalThis.regeneratorRuntime=v:Function("r","regeneratorRuntime = r")(v)}},5555:function(h,v,o){var g,f;g=function(){return function m(){var y=arguments.length;if(0===y)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===y)return e.href;var _=document.getElementsByTagName("head")[0];_.insertBefore(e,_.firstChild);for(var d,b=document.createElement("a"),T=1;T<y;T++)b.href=arguments[T],e.href=d=b.href;return _.removeChild(e),d}},void 0!==(f=g.call(v,o,v,h))&&(h.exports=f)},8926:h=>{function v(g,f,m,y,e,_,b){try{var d=g[_](b),T=d.value}catch(M){return void m(M)}d.done?f(T):Promise.resolve(T).then(y,e)}h.exports=function o(g){return function(){var f=this,m=arguments;return new Promise(function(y,e){var _=g.apply(f,m);function b(T){v(_,y,e,b,d,"next",T)}function d(T){v(_,y,e,b,d,"throw",T)}b(void 0)})}},h.exports.__esModule=!0,h.exports.default=h.exports},3681:h=>{"use strict";h.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.10.1","description":"FFmpeg WebAssembly version","main":"src/index.js","types":"src/index.d.ts","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}')}}]);